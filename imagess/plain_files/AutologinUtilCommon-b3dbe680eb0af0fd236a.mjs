(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["AutologinUtilCommon"],{"4NbJ":function(e,o,t){t.d(o,"a",(function(){return i})),t.d(o,"b",(function(){return r})),t.d(o,"e",(function(){return g})),t.d(o,"c",(function(){return l})),t.d(o,"d",(function(){return d})),t.d(o,"f",(function(){return b}));var n=t("bKKl"),a=t("37no");const i="postmessage",r="profile email",c="694505692171-31closf3bcmlt59aeulg2j81ej68j6hk.apps.googleusercontent.com",_="com.pinterest",s="offline",u="single_host_origin",g=()=>Object(a.c)("https://apis.google.com/js/client:platform.js",a.a.GPLUS_ONE);function l(e){const o={scope:r,client_id:c,app_package_name:_,access_type:s,cookie_policy:u},t=function(o){e&&e(o)};return new Promise((e,n)=>{g().then(()=>{t("google_script_load"),"undefined"!=typeof window&&window.gapi?window&&window.gapi&&window.gapi.auth2?(t("google_script_init_onuse"),window.gapi.auth2.init(o).then(o=>{t("google_init_success"),e(o)},({error:e})=>{t("google_init_error"),n("init_onuse_"+e)})):(t("google_script_init_exists"),window.gapi.load("auth2",{callback:()=>{t("google_auth2_load_complete"),window.gapi.auth2.init(o).then(o=>{t("google_init_success"),e(o)},({error:e})=>{t("google_init_error"),n("init_exists_"+e)})},onerror:({error:e})=>{t("google_auth2_script_load_error"),n(e)},timeout:15e3,ontimeout:()=>{t("google_auth2_script_load_timeout"),n("timeout")}})):t("google_init_error")})})}function d(e,o,t,a=!1){return function(e,o,t,a=!1){return new Promise((c,_)=>{if(a&&Object(n.a)())return void _();const s=function(e){t&&t(e)};s("google_button_init"),l(t).then(()=>{s("google_sdk_load"),"undefined"!=typeof window&&window.gapi?o.signin2.render(e,{scope:r,onsuccess:e=>{s("google_button_success");const o=e.getAuthResponse(!0),t={data:{gplus_id_token:o.id_token,gplus_access_token:o.access_token,gplus_expires_at:o.expires_at,gplus_autologin:a||!1},signupOptions:{gplus_code:"",gplus_id_token:o.id_token,gplus_redirect_uri:i}};c(t)},onfailure:()=>{s("google_button_failure"),_("gapi_signin2_render_error")}}):s("google_init_error")},e=>{s("google_auth2_sdk_init_error"),_(e)})})}(e,o,t,a)}function b(e,o){return new Promise((e,t)=>{Object(n.a)()?t():(o("google_button_init"),function(e){const o={scope:r,client_id:c,app_package_name:_,access_type:s,cookie_policy:u};return new Promise((t,n)=>{e("google_script_fetch"),Object(a.c)("https://apis.google.com/js/platform.js",a.a.GPLUS_ONE).then(()=>{e("google_script_load"),"undefined"!=typeof window&&window.gapi?window.gapi.load("auth2",{callback:()=>{var a,i;e("google_auth2_load");const r=null===(a=window.gapi)||void 0===a||null===(i=a.auth2)||void 0===i?void 0:i.init(o);r&&r.then(()=>{e("google_init_success"),t(r)},({error:o})=>{e("google_init_error"),n("gplus_simple_load_init_exists_"+o)})},onerror:({error:o})=>{e("google_auth2_script_load_error"),n("gplus_simple_load_"+o)},timeout:15e3,ontimeout:()=>{e("google_auth2_script_load_timeout"),n("gplus_simple_load_timeout")}}):e("google_init_error")})})}(o).then(n=>{o("google_sdk_load");const a=n.currentUser.get().getAuthResponse(!0);if(a){o("google_auth_data_found");const t={data:{gplus_id_token:a.id_token,gplus_access_token:a.access_token,gplus_expires_at:a.expires_at,gplus_autologin:!0}};e(t)}else o("google_auth_data_not_found"),t("gplus_user_not_logged_in")},e=>{o("google_auth2_sdk_init_error"),t(e)}))})}},AXUD:function(e,o,t){t.d(o,"a",(function(){return n})),t.d(o,"b",(function(){return a}));const n=412,a=429},Dm6y:function(e,o,t){t.r(o),t.d(o,"fbAutologin",(function(){return j})),t.d(o,"googleAutologin",(function(){return E}));var n=t("gxu6"),a=t("K316"),i=t("OCob"),r=t("kJuv"),c=t("28DW"),_=t("h7e3");var s=t("m2Wt"),u=t("h4v/"),g=t("Jr++"),l=t("Ncr9"),d=t("zwad"),b=t("htxO"),p=t("J8m7");const f=[p.r,p.i,p.t,p.p,p.v,p.s],h=e=>"facebook"===e?2:3,k=e=>{Object(c.a)("autologin."+e);const o=s.a.fromPlainObject({event_type:38,view_type:9});o.updateAuxData({login_provider:e,unauth_data:JSON.stringify({autologin:!0})}),u.a.getInstance().addEvent(o)},O=(e,o)=>{const t=s.a.fromPlainObject({event_type:o});t.updateAuxData({signup_login_method:h(e),unauth_data:JSON.stringify({autologin:!0})}),u.a.getInstance().addEvent(t)},m=e=>{O(e,7536),Object(l.a)((()=>{let e=window.nextUrlParam;const o={autologin:!0};if(!e&&(e=window.location.pathname||"/","/"!==e&&Object(b.a)(document.referrer)&&(o.lp="true"),Object.assign(o,Object(g.a)()),o)){const t=o.next;t&&(e=t,delete o.next)}return d.a.appendQueryString(e,o)})())},w=(e,o)=>{if(O(e,7535),!f.includes(o.api_error_code))throw o.api_error_code?Object(c.a)(`autologin.${e}.uncaught_api_error_code.${o.api_error_code}`):Object(c.a)(`autologin.${e}.uncaught_with_no_api_error_code`),o;n.b("google"===e?"galae":"fbalae",String(12),12)};var j=(e,o)=>{t.e("facebookEnsureInitForDesktop").then(t.bind(null,"TvzZ")).then(({default:t})=>{Object(c.a)("unauth_web.facebook_connect.autologin.attempt"),t(o=>{Object(_.b)("facebook_autologin","UnauthFacebookAutologinScriptLoadedEvent"),Object(c.a)("unauth_web.facebook_autologin.get_login_status.attempt"),o.getLoginStatus(o=>{Object(c.a)("unauth_web.facebook_connect.autologin.success"),"connected"===o.status&&(Object(c.a)("unauth_web.facebook_autologin.get_login_status.response_connected"),Object(_.b)("facebook_autologin","UnauthFacebookAutologinSuccessEvent"),e({type:"FB_AUTOLOGIN_CONNECTED",payload:{}})),function(e){if(n.a("fbalae")){Object(_.a)("facebook_autologin","autologin_disabled");const e=n.a("fbalae");Object(c.a)("autologin.facebook.skip_for_known_api_errors."+String(e))}else if(Object(c.a)("autologin.facebook_attempt.pure_react"),"connected"===e.status)if(n.a("fba"))Object(_.a)("facebook_autologin","autologin_disabled"),Object(c.a)("autologin.facebook.connected_but_disabled_via_user_cookie");else{const o=e.authResponse;if(!o)return Object(c.a)("autologin.facebook_fail"),void Object(_.a)("facebook_autologin","no_auth_response");Object(_.d)("facebook_autologin"),k("facebook"),O("facebook",7534),Object(r.a)({facebook_id:o.userID,facebook_token:o.accessToken,facebook_autologin:!0},Object(i.a)(),{container:"autologinfb"}).then(()=>{m("facebook")},e=>{w("facebook",e)})}else Object(_.a)("facebook_autologin","login_status_"+e.status)}(o),"not_authorized"===o.status?(Object(c.a)("unauth_web.facebook_autologin.get_login_status.response_not_authorized"),e({type:"FB_AUTOLOGIN_NOT_AUTHORIZED",payload:{}})):"authorization_expired"===o.status?(Object(c.a)("unauth_web.facebook_autologin.get_login_status.response_authorization_expired"),e({type:"FB_AUTOLOGIN_AUTH_EXPIRED",payload:{}})):e({type:"FB_AUTOLOGIN_UNKNOWN",payload:{}})})},a.a,o)})},v=t("fZ0m"),T=t("SyXB"),y=t("4NbJ");const S=e=>Object(_.b)("google_autologin_gsi",e),A=e=>Object(_.a)("google_autologin_gsi",e);var E=(e,o,t)=>{const a=!t||t.inPwtGsiGroup;if(n.a("galae")){const e=n.a("galae");return Object(c.a)("autologin.google.skip_for_known_api_errors."+String(e)),void(a&&A("skipForKnownApiErrors"))}if(n.a("fba"))return Object(c.a)("autologin.google.connected_but_disabled_via_user_cookie"),void(a&&A("connectedButDisabledViaUserCookie"));Object(T.c)("UnauthGoogleAutologinInitEvent"),a&&S("gapiStart"),v.a.get(e=>{Object(T.c)("UnauthGoogleAutologinScriptLoadedEvent"),Object(c.a)("autologin.google_start.pure_react"),t?(a&&S("googleAutologinStart"),Object(y.f)(e,e=>Object(c.a)("autologin."+e)).then((e={})=>{a&&Object(_.d)("google_autologin_gsi"),Object(c.a)("autologin.google_attempt.pure_react"),k("google"),O("google",7534),Object(T.c)("UnauthGoogleAutologinSuccessEvent"),Object(r.a)(e.data,Object(i.a)(),"autologingoogle",!1,void 0,void 0,!!t).then(()=>{Object(c.a)("autologin.login_success"),m("google")},e=>{Object(c.a)("mweb_autologin.google_fail"),Object(c.a)("autologin.login_failure"),w("google",e)})},e=>{a&&A("googleFail"),Object(c.a)("autologin.google_fail."+e),e&&-1!==e.indexOf("gplus_simple_load")&&Object(c.a)("mweb_autologin.google_fail")})):Object(c.a)("dev.autologin_disabled.google_v3")})}},K316:function(e,o,t){var n=t("mBfy");o.a=()=>n.default.isAuthenticated()&&!!n.default.attributes.facebook_id&&!n.default.isLimitedLogin()},Ncr9:function(e,o,t){var n=t("TPPM"),a=t("XdLN"),i=t("28DW");o.a=e=>{Object(a.a)(e)||(e="/",Object(i.a)("url_reset")),Object(n.a)(e,!1)}},OCob:function(e,o,t){var n=t("+NLT");o.a=()=>({referrer:n.a.instance.referrer,facebookToken:n.a.instance.facebook_token,unauthId:n.a.instance.unauth_id,origin:n.a.instance.origin,appType:n.a.instance.app_type})},bKKl:function(e,o,t){t.d(o,"a",(function(){return a}));var n=t("gxu6");const a=()=>!!n.a("logged_out")||!!n.a("fba")},dish:function(e,o,t){t.d(o,"a",(function(){return a})),t.d(o,"b",(function(){return i}));var n=t("QLqj");const a=()=>n.b.localStorage.getItem("uoiou")||!1,i=e=>{n.b.localStorage.setItem("uoiou",!!e)}},fZ0m:function(e,o,t){const n={get(e){const o="gplus";t.e("ScriptCommon").then(t.bind(null,"6tKR")).then(({default:t})=>{t.load([],"https://apis.google.com/js/client:platform.js",o),t.ready(o,()=>{e(window.gapi)})})}};o.a=n},htxO:function(e,o,t){t.d(o,"a",(function(){return a})),t.d(o,"b",(function(){return i}));var n=t("zwad");function a(e){const o=function(e){const{hostname:o}=n.a.parse(e,!0);if(o&&e){if(e.match(/^(http|https):\/\/(www.)?google\.com$|google\.(co|com)\.[a-z]{2}$|google\.[a-z]{2}$/))return"GOOGLE";if(o.includes("bing."))return"BING";if(o.includes("yahoo."))return"YAHOO"}return""}(e);return["GOOGLE","BING","YAHOO"].includes(o)}function i(e,o){const t=(((o||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>|<!--[\s\S]*/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,(e,o)=>t.indexOf("<"+o.toLowerCase()+">")>-1?e:"")}},kJuv:function(e,o,t){var n=t("eOdZ"),a=t("QLqj"),i=t("kmwA"),r=t("J8m7"),c=t("AXUD"),_=t("dish"),s=t("VL22"),u=t("OX7c"),g=t("28DW"),l=t("yM2L");const d=function(e){return e.mfa_token?"mfa_token":e.mfa_resend?"mfa_resend":e.facebook_id?s.a.FACEBOOK:e.google_open_id_token?s.a.GOOGLE_ONE_TAP:e.gplus_id_token?s.a.GOOGLE:e.phone_number?"phone_number":e.username_or_email?s.a.EMAIL:s.a.OTHER},b=function(e,o,t=!1){let n="referrer_unknown";try{const e=document.referrer;n=e?e.indexOf("/t.co/")>-1?"twitter":e.indexOf("google.")>-1?"google":e.indexOf("bing.")>-1?"bing":e.indexOf("facebook.")>-1?"facebook":"other":"direct"}catch(s){}const a=d(e),i=o===Object(o)?o.hybridTier:"tier_unknown",r=o===Object(o)?o.container:"container_unknown";Object(g.a)("login.referrer."+n+"."+a),Object(g.a)("login.container."+r+"."+a),Object(g.a)("login.type."+a);const c=d(e)||"method_unknown",_=o.page||"page_unknown";e.gplus_autologin?t?(Object(g.a)("mweb_autologin.google_success"),Object(g.h)("new_mweb_autologin_google",{page:_,referrer:n,container:r,hybridTier:i})):(Object(g.a)("web_autologin_google"),Object(g.h)("new_web_autologin_google",{page:_,referrer:n,container:r,hybridTier:i})):e.facebook_autologin?(Object(g.a)("web_autologin_facebook"),Object(g.h)("new_web_autologin_facebook",{page:_,referrer:n,container:r,hybridTier:i})):(Object(g.a)(`web_login.${c}.success.${_}.${r}.${n}.${i}`),Object(g.h)(`new_web_login.${c}.success`,{page:_,referrer:n,container:r,hybridTier:i}))},p=(e,o)=>{Object(g.a)(`web_cross_domain_login.${e}.${d(o)}`)},f=(e,o,t="unknown_source",n=!1)=>{if(e){const a=e.http_status===c.b?c.b:e.api_error_code;let i=a;r.b.has(a)&&(i=r.b.get(a));const{container:_}=o;n?Object(g.a)(`unauth_web_client_cctld_login_api_error.${String(i)}.${_||"unknow_container"}.${t}`):Object(g.a)(`unauth_web_client_login_api_error.${String(i)}.${_||"unknow_container"}.${t}`)}};o.a=function(e,o,t={},r=!1,c,s,g=!1){if(function(e){return!e.mfa_resend&&!!e.username_or_email}(e)){if(-1!==i.a.settings.CORS_HANDSHAKE_DOMAINS.indexOf(o.origin))return function(e,o,t,n){p("attempt",e);const{referrer:a,facebookToken:i,unauthId:r}=n;return Object(l.loginUser)(e,{recaptchaV3Token:o,referrer:a,facebookToken:i,unauthId:r}).then(o=>{if(o&&o.data){p("success_with_token",e);const n=o.data;return Object(l.exchangeTokenAndSetSession)(n).then(o=>(p("success_token_exchanged",e),b(e,t),Promise.resolve()),o=>{throw p("success_token_not_exchanged",e),o})}throw p("success_without_token",e),new Error},o=>{throw p("failure",e),f(o,t,d(e),!0),o})}(e,s,t,o)}const h=r?null:a.b.localStorage.getItem("visitedPagesBeforeLogin"),k={...e,get_user:e.get_user||e.switch_account&&r,app_type_from_client:7===o.appType?7:5,visited_pages_before_login:h?JSON.stringify(h):null,recaptchaV2Token:c,recaptchaV3Token:s};return n.a.create("UserSessionResource",k).callCreate({showError:!1,async:!0}).then(o=>(b(e,t,g),Object(_.b)(!1),Object(u.a)("login").then(()=>o)),o=>(f(o,t,d(e)),Promise.reject(o)))}},yM2L:function(e,o,t){t.r(o),t.d(o,"exchangeTokenAndSetSession",(function(){return u})),t.d(o,"verifyLoggedInStatus",(function(){return g})),t.d(o,"registerUser",(function(){return l})),t.d(o,"loginUser",(function(){return d}));var n=t("T0g9"),a=t("eOdZ"),i=t("kmwA"),r=t("28DW"),c=t("J8m7");const _=i.a.settings.ACCOUNTS_PINTEREST_URL,s=(e,o,t,n)=>{const a=e=>{const o=new Error(e.statusText);throw o.response=e,!o.api_error_code&&o.response&&(o.api_error_code=o.response.code,o.message=o.response.message),o},i={credentials:"include",mode:"cors"};return"POST"===t&&(i.method="POST",i.body=o,i.headers={"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","X-Pinterest-InstallId":n},n||Object(r.a)("unauth.auth_handshake.cross_domain.no_unauth_id."+t)),fetch(e,i).then(e=>200===e.status||401===e.status?e:(a(e),{})).then(e=>e.json()).then(e=>"success"===e.status?Promise.resolve(e):e.code===c.r?(e.api_error_code=e.code,Promise.reject(e)):(a(e),{})).catch(e=>{throw e})},u=(e,o=!1)=>a.a.create("HandshakeSessionResource",{token:e,isRegistration:o}).callCreate(),g=e=>{s(_+"/v3/handshake/verify/","","GET",e).then(e=>{if(e&&e.data){const o=e.data;u(o).then(e=>{window.location.reload()},e=>{})}},e=>{})},l=(e,{facebookToken:o,inviteCode:t,locale:a,referrer:r,unauthId:c})=>{const _=(e.business_name?"partner/handshake":(e.gplus_code||e.gplus_id_token)&&"gplus/handshake")||e.facebook_id&&"facebook/handshake"||"email/handshake",u={};if(u.email=e.email||"",u.username=e.username||"",u.password=e.password||"",u.first_name=e.first_name||"",u.last_name=e.last_name||"",u.country=e.country||"",u.locale=a,u.referrer=r,e.age){const o=new Date;o.setFullYear(o.getFullYear()-e.age);const t=parseInt(o/1e3,10);u.birthday=t.toString()}if(e.custom_gender&&(u.custom_gender=e.custom_gender),e.gender&&(u.gender=e.gender),e.business_name&&(u.account_type=e.account_type,u.business_name=e.business_name,u.first_name=e.business_name),t&&(u.invite_code=t),e.facebook_id){const t=o||e.facebook_token||"";u.facebook_id=e.facebook_id,u.facebook_token=t,u.social_username=e.social_username||""}else(e.gplus_code||e.gplus_id_token)&&(u.password=e.password||"",u.one_time_code=e.gplus_code,u.id_token=e.gplus_id_token,u.redirect_uri=e.gplus_redirect_uri);return e.recaptchaV3Token&&(u.recaptcha_v3_token=e.recaptchaV3Token),s(`${i.a.settings.ACCOUNTS_PINTEREST_URL}/v3/register/${_}/`,Object(n.a)(u),"POST",c)},d=(e,{facebookToken:o,recaptchaV3Token:t,referrer:a,unauthId:r})=>{const c=(e.mfa_token?"mfa/handshake":e.gplus_id_token&&"gplus/handshake")||e.facebook_id&&"facebook/handshake"||"handshake",_={};if(e.username_or_email&&(_.username_or_email=e.username_or_email.trim(),_.password=e.password,_.referrer=a),e.facebook_id){const t=o||e.facebook_token||"";_.facebook_id=e.facebook_id,_.facebook_token=t,_.facebook_autologin=e.facebook_autologin||!1}return e.gplus_id_token&&(_.gplus_id_token=e.gplus_id_token,_.gplus_access_token=e.gplus_access_token,_.gplus_expires_at=e.gplus_expires_at,_.gplus_autologin=e.gplus_autologin||!1),e.mfa_token&&(_.mfa_token=e.mfa_token),t&&(_.token=t),s(`${i.a.settings.ACCOUNTS_PINTEREST_URL}/v3/login/${c}/`,Object(n.a)(_),"POST",r)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/AutologinUtilCommon-b3dbe680eb0af0fd236a.mjs.map